<!DOCTYPE html>
<html lang="fr">
<head>
    <link rel="icon" type="image/png" href="favicon-96x96.png" sizes="96x96" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accueil | MCOCFR BETA</title>
    <meta property="og:title" content=" Accueil | MCOCFR BETA">
    <meta property="og:description" content="Bienvenue sur le site français de MCOC.">
    <meta property="og:image" content="https://raw.githubusercontent.com/Dems6468/MCOCFR-DEMO/4f245fcae05b3cca47f50c283444917ad7ae5ac2/favicon-96x96.png">
    <meta property="og:url" content="https://www.mcocfr.com">
    <meta property="og:type" content="website">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:title"  content=" Accueil | MCOCFR BETA">
    <meta name="twitter:description" content="Bienvenue sur le site français de MCOC.">
    <meta name="twitter:image" content="https://raw.githubusercontent.com/Dems6468/MCOCFR-DEMO/4f245fcae05b3cca47f50c283444917ad7ae5ac2/favicon-96x96.png">
    <meta name="twitter:card" content="summary_large_image">
    <link rel="stylesheet" href="style_foca.css"> <!-- Nouveau fichier CSS -->
    </style>
</head>
<body>

<!-- Header Mobile -->
<header id="header-mobile">
    <div class="logo">
        <a href="index.html">
            <img src="favicon-96x96.png" alt="Logo MCOCFR" />
            MCOCFR BETA
        </a>
    </div>
    <!-- Icône pour ouvrir et fermer le menu -->
    <span class="menu-icon" onclick="toggleMenu()">&#9776;</span>
</header>

<!-- Menu Latéral -->
<div id="side-menu" class="side-menu">
    <a href="javascript:void(0)" class="close-btn" onclick="closeMenu()">×</a>
    <a href="index.html">Accueil</a>
    <a href="debuff.html">Debuffs</a>
    <a href="#aaaa">Champions</a>
    <a href="#contact">Contact</a>
</div>

<!-- Header Principal -->
<header id="header">
    <div class="logo">
        <a href="index.html">
            <img src="favicon-96x96.png" alt="Logo MCOCFR" class="logo-pc" />
            MCOC FR BETA
        </a>
    </div>
    <nav>
        <ul>
            <li><a href="index.html">Accueil</a></li>
            <li><a href="debuff.html">Debuffs</a></li>
            <li><a href="#aaaa">Champions</a></li>
            <li><a href="#contact">Contact</a></li>
        </ul>
    </nav>
</header>

<div class="container">
    <!-- Champ de recherche -->
    <div style="display: flex; align-items: center;">
        <input type="text" id="searchInput" onkeyup="filterTable()" placeholder="Rechercher...">
         <button id="export-excel">Exporter en Excel</button>
         <button id="export-pdf">Exporter en PDF</button>
        <!-- Lien vers MTCGuia à côté de la barre de recherche -->
    </div>

    <!-- Texte d'attribution sous la barre de recherche -->
    <p class="attribution-text">Données provenant du site<a href="https://www.guiamtc.com/" target="_blank" class="mtcguia-link">GuiaMTC</a> traduites en français par JosianeJoestar.</p>

    <!-- Tableau pour afficher les données -->
    <table id="dataTable">
        <thead>
            <tr>
                <th onclick="sortTable('rang')">Rang</th>
                <th>Photo</th>
                <th onclick="sortTable('nom')">Nom</th>
                <th onclick="sortTable('prestige')">Prestige</th>
                <th>Relique</th>
                <th>Attaque</th>
                <th>Défense</th>
                <th>Vie</th>
                <th>Attaque</th>
            </tr>
        </thead>
        <tbody>
            <!-- Les données du tableau seront injectées ici -->
        </tbody>
    </table>
</div>

<!-- Footer -->
<footer>
    <p>Version 0.0 • DERNIERE MISE A JOUR LE 19 MARS 2025 • Made in FRANCE FR</p>
    <p>Ce site n'est pas sponsorisé, endossé ou affilié à Kabam ou Marvel.</p>
</footer>


<script>
    // Initialiser le menu à l'état fermé
    window.onload = function() {
        const menu = document.getElementById("side-menu");
        menu.style.left = "-250px";  // Assure que le menu est caché dès le départ
    };

    // Fonction pour ouvrir ou fermer le menu latéral
    function toggleMenu() {
        const menu = document.getElementById("side-menu");

        // Vérifie si le menu est caché à gauche ou ouvert
        if (menu.style.left === "-250px") {
            menu.style.left = "0";  // Ouvre le menu (glissement vers la droite)
        } else {
            menu.style.left = "-250px";  // Ferme le menu (glissement vers la gauche)
        }
    }

    // Fonction pour fermer le menu en cliquant sur la croix
    function closeMenu() {
        document.getElementById("side-menu").style.left = "-250px";
    }

    // Ferme le menu en cliquant en dehors de celui-ci
    window.onclick = function(event) {
        const menu = document.getElementById("side-menu");
        const menuIcon = document.querySelector(".menu-icon");

        // Si l'utilisateur clique en dehors du menu et de l'icône du menu
        if (!menu.contains(event.target) && event.target !== menuIcon) {
            menu.style.left = "-250px"; // Ferme le menu
        }
    }
</script>
  <script>
        // Exporter en Excel
        document.getElementById('export-excel').addEventListener('click', function () {
            const table = document.getElementById('dataTable');
            const wb = XLSX.utils.table_to_book(table, { sheet: "Sheet 1" });
            XLSX.writeFile(wb, "tableau.xlsx");
        });

        // Exporter en PDF sans autoTable
        document.getElementById('export-pdf').addEventListener('click', function () {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // Définir les styles de base pour le tableau
            const margin = 10;
            let x = margin;
            let y = margin + 10;

            // Récupérer les en-têtes du tableau
            const table = document.getElementById('dataTable');
            const headers = [];
            const rows = [];
            
            // Extraire les en-têtes (th)
            const ths = table.querySelectorAll('thead tr th');
            ths.forEach(th => headers.push(th.innerText));

            // Extraire les lignes (td)
            const trs = table.querySelectorAll('tbody tr');
            trs.forEach(tr => {
                const row = [];
                tr.querySelectorAll('td').forEach(td => row.push(td.innerText));
                rows.push(row);
            });

            // Ajouter les en-têtes au PDF
            doc.setFontSize(12);
            doc.setFont("helvetica", "bold");
            headers.forEach((header, index) => {
                doc.text(header, x + (index * 50), y);
            });

            // Ajouter les données des lignes
            y += 10; // espace entre les en-têtes et les données
            doc.setFont("helvetica", "normal");
            rows.forEach(row => {
                row.forEach((data, index) => {
                    doc.text(data, x + (index * 50), y);
                });
                y += 10; // Espacement entre les lignes
            });

            // Sauvegarder le fichier PDF
            doc.save('tableau.pdf');
        });
    </script>
    <script src="script_foca.js"></script>
</body>
</html>
